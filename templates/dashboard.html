<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ bot_name }} - Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="/static/css/dashboard.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Header Section -->
        <div class="header">
            <h1><i class="fas fa-music"></i> {{ bot_name }} Dashboard</h1>
            <div id="status-indicator" class="status-indicator status-healthy">
                <span class="status-dot online"></span>
                <span id="status-text">System Healthy</span>
            </div>
            <div class="auto-refresh">
                <div class="refresh-indicator"></div>
                <span>Auto-refresh: 30s</span>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab active" onclick="showTab('overview')">
                <i class="fas fa-dashboard"></i> Overview
            </button>
            <button class="tab" onclick="showTab('servers')">
                <i class="fas fa-server"></i> Servers
            </button>
            <button class="tab" onclick="showTab('performance')">
                <i class="fas fa-chart-line"></i> Performance
            </button>
            <button class="tab" onclick="showTab('system')">
                <i class="fas fa-cog"></i> System
            </button>
            <button class="tab" onclick="showTab('logs')">
                <i class="fas fa-list"></i> Logs
            </button>
        </div>

        <!-- Tab Content Areas -->
        
        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-info-circle"></i>
                            Bot Statistics
                        </div>
                    </div>
                    <div id="bot-stats">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Loading stats...</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-users"></i>
                            Server Overview
                        </div>
                    </div>
                    <div id="server-overview">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Loading servers...</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-music"></i>
                            Music Activity
                        </div>
                    </div>
                    <div id="music-activity">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Loading activity...</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-exclamation-triangle"></i>
                            Recent Issues
                        </div>
                    </div>
                    <div id="recent-issues">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Loading issues...</div>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid">
                <div class="card chart-card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-chart-area"></i>
                            Command Usage (24h)
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="usageChart"></canvas>
                    </div>
                </div>

                <div class="card chart-card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-chart-pie"></i>
                            Server Distribution
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="serverChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Servers Tab -->
        <div id="servers" class="tab-content">
            <div class="grid">
                <div class="card full-width">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-server"></i>
                            Connected Servers
                        </div>
                        <div class="card-controls">
                            <button onclick="refreshServers()" class="btn btn-primary">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                        </div>
                    </div>
                    <div id="servers-list">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Loading servers...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Tab -->
        <div id="performance" class="tab-content">
            <div class="grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-tachometer-alt"></i>
                            Response Times
                        </div>
                    </div>
                    <div id="response-times">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Loading metrics...</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-microchip"></i>
                            Resource Usage
                        </div>
                    </div>
                    <div id="resource-usage">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Loading resources...</div>
                    </div>
                </div>

                <div class="card chart-card full-width">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-chart-line"></i>
                            Performance Trends
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Tab -->
        <div id="system" class="tab-content">
            <div class="grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-info"></i>
                            System Information
                        </div>
                    </div>
                    <div id="system-info">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Loading system info...</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-database"></i>
                            Database Status
                        </div>
                    </div>
                    <div id="database-status">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Loading database info...</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-heart"></i>
                            Health Check
                        </div>
                    </div>
                    <div id="health-check">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Running health check...</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-lightbulb"></i>
                            Recommendations
                        </div>
                    </div>
                    <div id="recommendations">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Generating recommendations...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logs Tab -->
        <div id="logs" class="tab-content">
            <div class="grid">
                <div class="card full-width">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-exclamation-circle"></i>
                            Error Log
                        </div>
                        <div class="card-controls">
                            <button onclick="clearLogs()" class="btn btn-danger">
                                <i class="fas fa-trash"></i> Clear
                            </button>
                            <button onclick="refreshLogs()" class="btn btn-primary">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                        </div>
                    </div>
                    <div id="error-log">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Loading error log...</div>
                    </div>
                </div>

                <div class="card full-width">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-tools"></i>
                            Diagnostics
                        </div>
                    </div>
                    <div id="diagnostics-info">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Running diagnostics...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Connection Status Modal -->
    <div id="connection-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-wifi"></i> Connection Status</h3>
                <span class="close" onclick="closeConnectionModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div id="connection-status">
                    <div class="status-item">
                        <span>WebSocket:</span>
                        <span id="ws-status" class="status-disconnected">Disconnected</span>
                    </div>
                    <div class="status-item">
                        <span>Last Update:</span>
                        <span id="last-update">Never</span>
                    </div>
                </div>
                <div class="modal-actions">
                    <button onclick="reconnectWebSocket()" class="btn btn-primary">
                        <i class="fas fa-sync"></i> Reconnect
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Include JavaScript modules -->
    <script src="/static/js/dashboard-core.js"></script>
    <script src="/static/js/dashboard-charts.js"></script>
    <script src="/static/js/dashboard-websocket.js"></script>
    <script src="/static/js/dashboard-ui.js"></script>
    
    <!-- Initialize Dashboard -->
    <script>
        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', function() {
            try {
                initializeDashboard();
            } catch (error) {
                console.error('Dashboard initialization failed:', error);
                showError('Dashboard initialization failed. Please refresh the page.');
            }
        });
    </script>
</body>
</html>